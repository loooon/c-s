package com.credit.common.util;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.util.ArrayList;
import java.util.List;

import com.alibaba.fastjson.JSON;
import com.alibaba.fastjson.JSONObject;

public final class CmdUtils
{

    private static final String CHARSET = "UTF-8";

    private static final Runtime RUNTIME = Runtime.getRuntime();

    public static List<String> execute(final String cmd, final String[] envp, final String charset) throws Exception
    {
        String curCharset = charset;
        if (curCharset == null || curCharset.trim().length() == 0)
        {
            curCharset = CHARSET;
        }
        List<String> resultList = new ArrayList<String>();
        Process process = null;
        BufferedReader bufferedReader = null;
        InputStream inputStream = null;
        try
        {
            process = RUNTIME.exec(cmd, envp);
            inputStream = process.getErrorStream();

            bufferedReader = new BufferedReader(new InputStreamReader(inputStream, curCharset));
            String line;
            while ((line = bufferedReader.readLine()) != null)
            {
                resultList.add(line);
            }
            if (resultList.size() == 0)
            {
                inputStream = process.getInputStream();
                bufferedReader = new BufferedReader(new InputStreamReader(inputStream, curCharset));
                while ((line = bufferedReader.readLine()) != null)
                {
                    resultList.add(line);
                }
            }
        }
        finally
        {
            try
            {
                inputStream.close();
            }
            catch (Exception e)
            {
            }
            try
            {
                bufferedReader.close();
            }
            catch (IOException e)
            {
            }
            try
            {
                process.waitFor();
            }
            catch (Exception e)
            {
            }
        }
        return resultList;
    }

    public static void main(String[] args) throws Exception
    {
        // List<String> resultList = execute("python D:\\IdeaProject\\credit-site\\credit-web\\src\\main\\resources\\script\\request_tag360.py 95555 95535 10086",null, CHARSET);
        List<String> resultList = execute(
                "python D:\\IdeaProject\\credit-site\\credit-web\\target\\credit-web-1.0.0-SNAPSHOT\\WEB-INF\\classes/script/request_tag360.py 13559251112 18558986091 02169777888 13788830970 18105951958 18649966177 20160130 20160131 15659086909 4009986998 ",
                null, CHARSET);
        //18150970678 13400814449 13489776713 01084359036  05922387392 15387951048 15980025155 13665904111 13959877982 15294582049 20160102 20160103 20160101 20160108 18650599941 20160109 88886757 20160106 20160107 20160104 20160105 059583083688 13960290130 02161290422 15027284567 02161290429 18060082016 13015870767 15960422771 15905085571 15259385879 15860425255 20160120 20160121 20160229 18959973210 15980765670 20160227 20160124 20151204 20160228 20160125 20151203 20160225 20160122 20151202 059588887128 20160226 20160123 20151201 20160223 20160128 20151208 20160224 20160129 20151207 20160221 20160126 20151206 20160222 20160127 20151205 20160220 13559524446 20151209 13774833133 18859533293 13559516255 20160218 20160219 20151211 20160110 20151210 20160214 20160111 20151213 059582226800 20160215 20160112 20151212 20160216 20160113 20151215 13750000595 20160217 20160114 20151214 15106071329 20160210 20160115 20151217 20160211 20151216 20160212 20160117 20151219 20160213 20160118 20151218 18150991360 20160119 15859736730 15059770367 96336 15059586830 15106006200 15980434939 15905912019 18965781872 20160202 20160201 20160204 15259545809 20160203 20160206 20160205 18250253591 20160208 20160207 20160209 15260807528 13799493769 15559551551 059588769107 075586013860 15980434955 059588737543 15260340364 18359877111 13645901835 15860563633 15060880775 13055816756 15759817475 13559540695 18105936669 13358557678 88805883 4008197179 18250256451 18659709721 13960358098 13599983324 15260472682 13505003133 88801881 13615925355 059583129999 15860474670 13559362238 059110016 18750464059 15260866325 13079703429 15160400700 15759324590 18060072550 18859476189 13506087222 13799597700 88991573 15306952369 02120396500 13067478883 059588860785 15959997028 15980481278 18960315018 13489870103 15906008733 18750625508 17087186945 18606958089 15280092737 13799229413 15959559171 18750441886 059524669537 15860420161 13489817740 18575275406 18397713722 18259550173 0591101570922 059588801881 13694895345 15060870808 02989199428 18596765590 95533 15059559737 02131017192 20160404 18650314134 20160403 20160402 20160401 88254222 20160408 20160407 20160406 20160405 15750981938 18960397588 18005053502 20160409 17750976789 059583015657 13559047444 20160313 20160314 20160410 20160315 20160411 20160316 20160317 20160318 20160319 82226800 20160416 20160417 20160418 20160419 20160412 20160413 20160310 20160414 20160311 15759588886 02096585 20160415 20160312 059583083022 15159597839 20160510 95511 20160512 20160511 20160514 20160513 20160515 20160421 20160326 20160422 20160327 20160324 20160420 20160325 88782059 20160328 18065477748 20160329 20160429 13959794425 18259583385 20160427 20160428 20160425 20160322 20160426 20160323 20160423 20160320 20160424 20160321 15259412190 02131017093 13805994118 18016691999 13905953107 15905002006 20160430 13285032269 18359577111 18859990130 18960251560 20160308 20160309 15259574444 20160306 059587558372 20160307 20160304 20160305 20160508 20160302 059588805883 20160509 20160303 13600742289 20160301 13505951811 15392209525 20160507 4009987101 20160506 20160505 13107828538 20160504 20160503 20160502 20160501 13959781720 13599949921 13489899841 059522000258 15306958969 18016638430 15985973088 13859885812 13489397571 15959899578 13506954199 15260719728 18659005148 13600888549 18016638427 15750942277 13599289960 13178214860 059588878916 15059589508 83281100 20151230 20160331 20151231 18859732799 20160330 10010 13505083168 18859994327 059582222279 88982339 18960413555 20151220 18350592908 13960939691 059524690261 20151221 20151222 15106072506 20151223 20151224 20151225 88737543 20151226 20151227 20151228 20151229 059588895757 15960773380 15860914797 13959987559 87191757 15260489324 15359615580 13665929390 95580 15805978698 13799881272 13636918313 18473415528 15980079586 15880899614 17750058282 18705929999 13626063391 15559585057 13626096293 02110101058 15559077376 059583897769 15759535523 17750864440 13788855484 13505986628 18649972458
        for (String line : resultList)
        {
            System.out.println(line);
//            JSONObject jsonObject = JSON.parseObject(line);
//            Object o = jsonObject.get("95555");
//            System.out.println(o);
        }
    }
}
